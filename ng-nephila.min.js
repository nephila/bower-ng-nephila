/*!
 * ngNephila
 * v0.0.3
 * Copyright 2015 Nephila http://nephila.it/
 * See LICENSE in this repository for license information
 */
!function(){angular.module("ngNephila",["ngNephila.filters","ngNephila.services","ngNephila.components"]),angular.module("ngNephila.filters",["ngNephila.filters.range","ngNephila.filters.titlecase","ngNephila.filters.stripHtml","ngNephila.filters.strip","ngNephila.filters.path"]),angular.module("ngNephila.filters.path",[]).filter("nphPath",function(){return function(e,n,t){for(var i="/";n.length>0&&-1!=i.indexOf(n.charAt(0));)n=n.substr(1);for(;n.length>0&&-1!=i.indexOf(n.charAt(n.length-1));)n=n.substr(0,n.length-1);return t||(n+="/"),e+("/"===e.charAt(e.length-1)?"":"/")+n}}),angular.module("ngNephila.filters.range",[]).filter("nphRange",function(){return function(e,n,t){var i=[],a=!0;if(1>t)throw new Error("Step parameter must be >= 1");if(t=void 0===t||null===t?1:t,(void 0===n||null===n)&&(n=e,e=0),e>n){var r=n;n=e,e=r,a=!1}for(var l=e;n>l;l+=t)a?i.push(l):i.unshift(l);return i}}),angular.module("ngNephila.filters.stripHtml",[]).filter("nphStripHtml",function(){return function(e){return e?String(e).replace(/<[^>]+>/gm,""):""}}),angular.module("ngNephila.filters.strip",[]).filter("nphStrip",function(){return function(e,n){for(n=n||" ";e.length>0&&-1!=n.indexOf(e.charAt(0));)e=e.substr(1);for(;e.length>0&&-1!=n.indexOf(e.charAt(e.length-1));)e=e.substr(0,e.length-1);return e}}),angular.module("ngNephila.filters.titlecase",[]).filter("nphTitlecase",function(){return function(e,n){e=void 0===e||null===e?"":e,n=void 0===n||null===n?!1:n;var t=/\b([a-z])/g;return n&&(t=/\b([a-z])/),e.toString().toLowerCase().replace(t,function(e){return e.toUpperCase()})}}),angular.module("ngNephila.services.debounce",[]).factory("nphDebounce",["$timeout","$q",function(e,n){return function(t,i,a){var r,l=n.defer();return function(){var o=this,s=arguments,c=function(){r=null,a||(l.resolve(t.apply(o,s)),l=n.defer())},p=a&&!r;return r&&e.cancel(r),r=e(c,i),p&&(l.resolve(t.apply(o,s)),l=n.defer()),l.promise}}}]),angular.module("ngNephila.services",["ngNephila.services.pagination","ngNephila.services.debounce","ngNephila.services.scrolledInContainer","ngNephila.services.tts","ngNephila.services.pathJoin"]),angular.module("ngNephila.services.pagination",[]).provider("nphPagination",function(){function e(){this.getPaginator=function(){return new n}}function n(){var e,n=function(e){},i=1;this.onPageChange=function(e){n=e},this.getCurrentPage=function(){return i},this.goToPage=function(e){if(1>e||e>this.getNumberOfPages())throw new Error("Wrong page to go to");i=e,n(e)},this.next=function(){i+1<=this.getNumberOfPages()&&i++,n(i)},this.prev=function(){i-1>0&&i--,n(i)},this.setNumberOfItems=function(n){return e=n},this.getNumberOfPages=function(){return Math.ceil(e/t)}}var t=0;this.setItemsPerPage=function(e){t=e},this.$get=function(){return new e}}),angular.module("ngNephila.services.pathJoin",["ngNephila.filters.path"]).factory("nphPathJoin",["$filter",function(e){return function(){var n=!1,t=arguments.length;"boolean"==typeof arguments[arguments.length-1]&&(n=arguments[arguments.length-1],t--);for(var i=arguments[0],a=1;t>a;a++)i=e("nphPath")(i,arguments[a],!0);return n||(i+="/"),i}}]),angular.module("ngNephila.services.scrolledInContainer",[]).factory("nphScrolledInContainer",function(){return function(e,n){var t=e.getBoundingClientRect(),i=(!e.style.opacity||e.style.opacity>0)&&"none"!==e.style.display&&"hidden"!==e.style.visibility;if(!i)return!1;if(!n.getBoundingClientRect)return t.top>=0&&t.bottom<=n.innerHeight;var a=n.getBoundingClientRect();return t.bottom<=a.bottom}}),angular.module("ngNephila.services.tts",[]).factory("nphTts",["$q",function(e){var n,t,i=!1,a=!1;return responsiveVoice.OnVoiceReady=function(){i===!1&&(void 0!==n&&n.call(),i=!0)},{isReady:function(){return i},onVoiceReady:function(e){n=e},stop:function(){a&&(t&&t.resolve(),responsiveVoice.cancel(),a=!1)},speak:function(n,i,r){a&&this.stop(),t=e.defer(),void 0===i&&(i="UK English Male"),void 0===r&&(r={}),r.onstart=function(){a=!0},r.onend=function(){a&&t&&t.resolve()};try{responsiveVoice.speak(n,i,r)}catch(l){t.reject(l)}return t.promise}}}]),angular.module("ngNephila.components.datePicker",["ngNephila.tpls.datepicker.datepicker"]).directive("nphDatePicker",["$document",function(e){return{restrict:"E",scope:{ngModel:"="},link:function(n,t,i){n.viewFormat=i.viewFormat||"DD MMMM YYYY",n.locale=i.locale||"en",n.firstWeekDaySunday=n.$eval(i.firstWeekDaySunday)||!1,n.placeholder=i.placeholder||"",n.calendarOpened=!1,n.days=[],n.dayNames=[],n.viewValue=null,n.dateValue=null,moment.locale(n.locale);var a=moment(n.ngModel);n.viewValue=a.format(n.viewFormat);var r=function(e){var t=e.endOf("month").date(),i=e.month(),a=e.year(),r=1,l=n.firstWeekDaySunday===!0?e.set("date",2).day():e.set("date",1).day();1!==l&&(r-=l-1),n.dateValue=e.format("MMMM YYYY"),n.days=[];for(var o=r;t>=o;o+=1)o>0?n.days.push({day:o,month:i+1,year:a,enabled:!0}):n.days.push({day:null,month:null,year:null,enabled:!1})},l=function(){for(var e=n.firstWeekDaySunday===!0?moment("2015-06-07"):moment("2015-06-01"),t=0;7>t;t+=1)n.dayNames.push(e.format("ddd")),e.add("1","d")};l(),n.showCalendar=function(){n.calendarOpened=!0,r(a)},n.closeCalendar=function(){n.calendarOpened=!1},n.prevYear=function(){a.subtract(1,"Y"),r(a)},n.prevMonth=function(){a.subtract(1,"M"),r(a)},n.nextMonth=function(){a.add(1,"M"),r(a)},n.nextYear=function(){a.add(1,"Y"),r(a)},n.selectDate=function(e,t){e.preventDefault();var i=moment(t.day+"."+t.month+"."+t.year,"DD.MM.YYYY");n.ngModel=i.toDate(),n.viewValue=i.format(n.viewFormat),n.closeCalendar()};var o=["datepicker","datepicker-input"];void 0!==i.id&&o.push(i.id),e.on("click",function(e){if(n.calendarOpened){var t,i=0;if(e.target){for(t=e.target;t;t=t.parentNode){var a=t.id,r=t.className;if(void 0!==a)for(i=0;i<o.length;i+=1)if(a.indexOf(o[i])>-1||r.indexOf(o[i])>-1)return}n.closeCalendar(),n.$apply()}}})},templateUrl:function(e,n){return n.templateUrl||"template/datepicker/datepicker.html"}}}]),angular.module("ngNephila.components.fallbackImg",[]).directive("nphFallbackImg",function(){return{restrict:"A",link:function(e,n,t){n.bind("error",function(){angular.element(this).attr("src",t.nphFallbackImg)})}}}),angular.module("ngNephila.components.focusMe",[]).directive("nphFocusMe",["$timeout",function(e){return{restrict:"A",link:function(n,t,i){n.$watch(i.nphFocusMe,function(n){n===!0&&e(function(){t[0].focus()})})}}}]),angular.module("ngNephila.components.infinitescroll",["ngNephila.services.scrolledInContainer"]).directive("nphInfiniteScroll",["$window","$rootScope","nphScrolledInContainer",function(e,n,t){return{restrict:"E",scope:{scrollContainer:"=",onInfinite:"&",ngIf:"&"},link:function(i,a,r){var l,o=!1,s=angular.element(e),c=null,p=function(){i.ngIf()!==!1&&(l=t(a[0],c[0]),l&&!o?(o=!0,i.$$phase||n.$$phase?i.onInfinite():i.$apply(i.onInfinite)):!l&&o&&(o=!1))},u=function(e){return null!=c&&c.unbind("scroll",p),c=e,null!=e?c.bind("scroll",p):void 0};u(i.scrollContainer?angular.element(i.scrollContainer):s),p()}}}]),angular.module("ngNephila.components.modal",["ngNephila.tpls.modal.modal"]).directive("nphModal",function(){return{restrict:"E",scope:{show:"="},transclude:!0,link:function(e,n,t,i){e.dialogStyle={},e.hideModal=function(){e.show=!1}},templateUrl:function(e,n){return n.templateUrl||"template/modal/modal.html"}}}),angular.module("ngNephila.components",["ngNephila.components.infinitescroll","ngNephila.components.fallbackImg","ngNephila.components.paginator","ngNephila.components.toggle","ngNephila.components.datePicker","ngNephila.components.modal","ngNephila.components.tabsaccordion","ngNephila.components.focusMe"]),angular.module("ngNephila.components.paginator",["ngNephila.services.pagination","ngNephila.filters.range","ngNephila.tpls.paginator.paginator"]).directive("nphPaginator",["$filter","nphPagination",function(e,n){return{restrict:"E",scope:{onPageChange:"&",numberOfItems:"=",start:"=",compress:"@",prevLabel:"@",nextLabel:"@",compressLabel:"@"},templateUrl:function(e,n){return n.templateUrl||"template/paginator/paginator.html"},controller:["$scope",function(t){t.pagesVisibility=[],t.paginator=n.getPaginator(),t.paginator.setNumberOfItems(parseInt(t.numberOfItems)),t.pages=e("nphRange")(1,1+t.paginator.getNumberOfPages()),t.calculatePagesVisiblity=function(){var e=parseInt(t.compress);if(e){var n=t.paginator.getCurrentPage(),i=t.paginator.getNumberOfPages();if(i){t.pagesVisibility=new Array(i+1);var a=n-e,r=n+e,l=!1,o=!1;0>a&&(r+=-1*a,a=1);for(var s=1;i>=s;s++)t.pagesVisibility.splice(s,0,{visibility:!1,firstHide:!1}),3>s||s>i-2?t.pagesVisibility[s].visibility=!0:(a>s?t.pagesVisibility[s].visibility=!1:s>r?t.pagesVisibility[s].visibility=!1:t.pagesVisibility[s].visibility=!0,t.pagesVisibility[s].visibility===!1&&(l||(t.pagesVisibility[s].firstHide=!0,l=!0)),s==r+1&&l&&!o&&(t.pagesVisibility[s].firstHide=!0,o=!0));a-2>=1&&t.pagesVisibility[a-2].visibility===!0&&(t.pagesVisibility[a-1].visibility=!0,t.pagesVisibility[a-1].firstHide=!1),i>r+2&&t.pagesVisibility[r+2].visibility===!0&&(t.pagesVisibility[r+1].visibility=!0,t.pagesVisibility[r+1].firstHide=!1)}}},t.canHide=function(e){return t.pagesVisibility.length?!t.pagesVisibility[e].visibility&&!t.pagesVisibility[e].firstHide:!1},t.isFirstCanHide=function(e){return t.pagesVisibility.length?t.pagesVisibility[e].firstHide:!1},t.paginator.onPageChange(function(e){t.onPageChange({page:e}),t.calculatePagesVisiblity()}),t.paginator.goToPage(parseInt(t.start))}],link:function(n,t,i){n.$watch("numberOfItems",function(t,i){n.paginator.setNumberOfItems(parseInt(t)),n.pages=e("nphRange")(1,1+n.paginator.getNumberOfPages()),n.calculatePagesVisiblity()})}}}]),angular.module("ngNephila.components.tabsaccordion",[]).directive("nphTabsaccordion",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,controller:function(e){var n=this;n.$scope=e,e.statuses={},e.contents={},e.setStatus=function(n,t){if(t===!0)for(var i in e.statuses)e.statuses[i]=!1;e.statuses[n]=t},e.getStatus=function(n){return e.statuses[n]},e.setContent=function(n,t){e.contents[n]=t},e.getContent=function(n){return e.contents[n]}},link:function(e,n,t,i){},template:"<div ng-transclude></div>"}}).directive("nphTabheaders",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,controller:function(e){},link:function(e,n,t,i){},template:'<ul class="tab-headers" ng-transclude></ul>'}}).directive("nphTabcontents",function(){return{restrict:"E",scope:{},transclude:!0,replace:!0,controller:function(e){},link:function(e,n,t,i){},template:'<div class="tab-contents" ng-transclude></div>'}}).directive("nphTabheader",function(){return{scope:{ref:"@",selected:"="},require:"^nphTabsaccordion",restrict:"E",transclude:!0,replace:!0,link:function(e,n,t,i){e.selected=e.selected||!1,i.$scope.setStatus(t.ref,e.selected),i.$scope.setContent(t.ref,n.find("a")[0].innerHTML),n.find("a").on("click",function(n){n.preventDefault(),e.$apply(i.$scope.setStatus(t.ref,!0))}),i.$scope.$watch("statuses."+t.ref,function(n,a){e.selected=i.$scope.getStatus(t.ref)})},template:'<li ng-class="{\'tab-active\':selected}"><a href="#{{ref}}" ng-transclude></a></li>'}}).directive("nphTabcontent",["$sce",function(e){return{scope:{ref:"@"},require:"^nphTabsaccordion",restrict:"E",transclude:!0,replace:!0,link:function(n,t,i,a){n.selected=!1,t.find("a").on("click",function(e){e.preventDefault(),n.$apply(a.$scope.setStatus(i.ref,!0))}),n.content=e.trustAsHtml(a.$scope.getContent(i.ref)),a.$scope.$watch("statuses."+i.ref,function(e,t){n.selected=a.$scope.getStatus(i.ref)})},template:'<div><div class="accordion-link" ng-class="{\'accordion-active\':selected}"><a href="#{{ref}}" ng-bind-html="content"></a></div><div ng-class="{\'tab-active\':selected, \'accordion-active\':selected}" class="tab-content" id="{{ref}}" ng-transclude></div></div>'}}]),angular.module("ngNephila.components.toggle",[]).directive("nphToggle",["$rootScope",function(e){return{restrict:"AE",scope:{state:"="},link:function(n,t,i){var a=i.toggleClass,r=function(){n.state=!n.state};a||(a="active"),n.state?t.addClass(a):t.removeClass(a),t.bind("click",function(){t.toggleClass(a),n.$$phase||e.$$phase?n.toggleState():n.$apply(r)})}}}]),function(e){try{e=angular.module("ngNephila.tpls.datepicker.datepicker")}catch(n){e=angular.module("ngNephila.tpls.datepicker.datepicker",[])}e.run(["$templateCache",function(e){e.put("template/datepicker/datepicker.html",'<input type="text" ng-focus="showCalendar()" ng-value="viewValue" class="datepicker-input"placeholder="{{ placeholder }}"/>\n<div class="datepicker" ng-show="calendarOpened">\n  <div class="datepicker-controls">\n    <div class="datepicker-previous">\n      <i class="datepicker-prev-year" ng-click="prevYear()"></i>\n      <i class="datepicker-prev-month" ng-click="prevMonth()"></i>\n    </div>\n    <span class="datepicker-date" ng-bind="dateValue"></span>\n    <div class="datepicker-next">\n      <i class="datepicker-next-month" ng-click="nextMonth()"></i>\n      <i class="datepicker-next-year" ng-click="nextYear()"></i>\n    </div>\n  </div>\n  <div class="datepicker-day-names">\n    <span ng-repeat="dn in dayNames">\n      {{ dn }}\n    </span>\n  </div>\n  <div class="datepicker-calendar">\n    <span ng-repeat="d in days" class="datepicker-day" ng-click="selectDate($event, d)" ng-class="{disabled: !d.enabled}">\n      {{ d.day }}\n    </span>\n  </div>\n</div>')}])}(),function(e){try{e=angular.module("ngNephila.tpls.modal.modal")}catch(n){e=angular.module("ngNephila.tpls.modal.modal",[])}e.run(["$templateCache",function(e){e.put("template/modal/modal.html",'<div class="overlay" ng-show="show" ng-click="hideModal();">\n  <div class="overlay-content">\n    <div class="modal" ng-transclude ng-click="$event.stopPropagation();">\n    </div>\n  </div>\n</div>')}])}(),function(e){try{e=angular.module("ngNephila.tpls.paginator.paginator")}catch(n){e=angular.module("ngNephila.tpls.paginator.paginator",[])}e.run(["$templateCache",function(e){e.put("template/paginator/paginator.html",'<ul>\n  <li>\n    <a href="" ng-click="paginator.prev()">{{prevLabel || "&lt;&lt;"}}</a>\n  </li>\n  <li ng-hide="canHide(i)" ng-class="{active: i == paginator.getCurrentPage()}" ng-repeat="i in pages">\n    <a href="" ng-hide="isFirstCanHide(i)" ng-click="paginator.goToPage(i)">{{i}}</a>\n    <span ng-show="isFirstCanHide(i)">{{compressLabel || "..."}}</span>\n  </li>\n  <li>\n    <a href="" ng-click="paginator.next()">{{nextLabel || "&gt;&gt;"}}</a>\n  </li>\n</ul>')}])}()}();